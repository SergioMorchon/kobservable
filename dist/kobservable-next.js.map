{"version":3,"file":"kobservable-next.js","sources":["../build/observable.js","../build/computed.js"],"sourcesContent":["const equals = (v1, v2) => Number.isNaN(v1) && Number.isNaN(v2)\n    ? true\n    : v1 === v2;\n/**\n * Creates a new observable instance.\n * @param initialValue The initial value.\n */\nexport default function observable(initialValue) {\n    let data = initialValue;\n    const subscriptions = new Set();\n    const observableContainer = function (value) {\n        if (arguments.length) {\n            if (!equals(data, value)) {\n                data = value;\n                subscriptions.forEach(subscription => subscription(data));\n            }\n            return this;\n        }\n        else {\n            return data;\n        }\n    };\n    observableContainer.subscribe = subscription => {\n        subscriptions.add(subscription);\n    };\n    observableContainer.unsubscribe = subscription => {\n        subscriptions.delete(subscription);\n    };\n    observableContainer.unsubscribeAll = () => {\n        subscriptions.clear();\n    };\n    return observableContainer;\n}\n//# sourceMappingURL=observable.js.map","const empty = {};\nexport default function computed(sources, compute) {\n    let memoizedData = empty;\n    let attached = false;\n    const subscriptions = new Set();\n    const updateData = () => {\n        memoizedData = compute(sources.map(getter => getter()));\n    };\n    const subscription = () => {\n        updateData();\n        subscriptions.forEach(subscription => subscription(memoizedData));\n    };\n    const attach = () => {\n        sources.forEach(source => source.subscribe(subscription));\n        attached = true;\n    };\n    const detach = () => {\n        sources.forEach(source => source.unsubscribe(subscription));\n        attached = false;\n    };\n    const checkSubscriptions = () => {\n        if (subscriptions.size && !attached) {\n            attach();\n        }\n        else if (!subscriptions.size && attached) {\n            detach();\n        }\n    };\n    const computedContainer = function () {\n        if (memoizedData === empty) {\n            updateData();\n        }\n        return memoizedData;\n    };\n    computedContainer.subscribe = s => {\n        subscriptions.add(s);\n        checkSubscriptions();\n    };\n    computedContainer.unsubscribe = s => {\n        subscriptions.delete(s);\n        checkSubscriptions();\n    };\n    computedContainer.unsubscribeAll = () => {\n        subscriptions.clear();\n        checkSubscriptions();\n    };\n    return computedContainer;\n}\n//# sourceMappingURL=computed.js.map"],"names":[],"mappings":"AAAA,IAAM,SAAS,SAAT,MAAS,CAAC,EAAD,EAAK,EAAL;WAAY,OAAO,KAAP,CAAa,EAAb,KAAoB,OAAO,KAAP,CAAa,EAAb,CAApB,GACrB,IADqB,GAErB,OAAO,EAFE;CAAf;;;;;AAOA,AAAe,SAAS,UAAT,CAAoB,YAApB,EAAkC;QACzC,OAAO,YAAX;QACM,gBAAgB,IAAI,GAAJ,EAAtB;QACM,sBAAsB,SAAtB,mBAAsB,CAAU,KAAV,EAAiB;YACrC,UAAU,MAAd,EAAsB;gBACd,CAAC,OAAO,IAAP,EAAa,KAAb,CAAL,EAA0B;uBACf,KAAP;8BACc,OAAd,CAAsB;2BAAgB,aAAa,IAAb,CAAhB;iBAAtB;;mBAEG,IAAP;SALJ,MAOK;mBACM,IAAP;;KATR;wBAYoB,SAApB,GAAgC,wBAAgB;sBAC9B,GAAd,CAAkB,YAAlB;KADJ;wBAGoB,WAApB,GAAkC,wBAAgB;sBAChC,MAAd,CAAqB,YAArB;KADJ;wBAGoB,cAApB,GAAqC,YAAM;sBACzB,KAAd;KADJ;WAGO,mBAAP;CAEJ;;ACjCA,IAAM,QAAQ,EAAd;AACA,AAAe,SAAS,QAAT,CAAkB,OAAlB,EAA2B,OAA3B,EAAoC;QAC3C,eAAe,KAAnB;QACI,WAAW,KAAf;QACM,gBAAgB,IAAI,GAAJ,EAAtB;QACM,aAAa,SAAb,UAAa,GAAM;uBACN,QAAQ,QAAQ,GAAR,CAAY;mBAAU,QAAV;SAAZ,CAAR,CAAf;KADJ;QAGM,eAAe,SAAf,YAAe,GAAM;;sBAET,OAAd,CAAsB;mBAAgB,aAAa,YAAb,CAAhB;SAAtB;KAFJ;QAIM,SAAS,SAAT,MAAS,GAAM;gBACT,OAAR,CAAgB;mBAAU,OAAO,SAAP,CAAiB,YAAjB,CAAV;SAAhB;mBACW,IAAX;KAFJ;QAIM,SAAS,SAAT,MAAS,GAAM;gBACT,OAAR,CAAgB;mBAAU,OAAO,WAAP,CAAmB,YAAnB,CAAV;SAAhB;mBACW,KAAX;KAFJ;QAIM,qBAAqB,SAArB,kBAAqB,GAAM;YACzB,cAAc,IAAd,IAAsB,CAAC,QAA3B,EAAqC;;SAArC,MAGK,IAAI,CAAC,cAAc,IAAf,IAAuB,QAA3B,EAAqC;;;KAJ9C;QAQM,oBAAoB,SAApB,iBAAoB,GAAY;YAC9B,iBAAiB,KAArB,EAA4B;;;eAGrB,YAAP;KAJJ;sBAMkB,SAAlB,GAA8B,aAAK;sBACjB,GAAd,CAAkB,CAAlB;;KADJ;sBAIkB,WAAlB,GAAgC,aAAK;sBACnB,MAAd,CAAqB,CAArB;;KADJ;sBAIkB,cAAlB,GAAmC,YAAM;sBACvB,KAAd;;KADJ;WAIO,iBAAP;CAEJ;;"}