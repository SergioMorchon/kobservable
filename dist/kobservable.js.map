{"version":3,"file":"kobservable.js","sources":["../build/equals.js","../build/observable.js","../build/computed.js","../build/throttled.js"],"sourcesContent":["const equals = (v1, v2) => Number.isNaN(v1) && Number.isNaN(v2)\n    ? true\n    : v1 === v2;\nexport default equals;\n//# sourceMappingURL=equals.js.map","import equals from './equals';\n/**\n * Creates a new observable instance.\n * @param initialValue The initial value.\n */\nexport default function observable(initialValue) {\n    let data = initialValue;\n    const subscriptions = new Set();\n    const observableContainer = function (value) {\n        if (arguments.length) {\n            if (!equals(data, value)) {\n                data = value;\n                subscriptions.forEach(subscription => subscription(data));\n            }\n            return this;\n        }\n        else {\n            return data;\n        }\n    };\n    observableContainer.subscribe = subscription => {\n        subscriptions.add(subscription);\n    };\n    observableContainer.unsubscribe = subscription => {\n        subscriptions.delete(subscription);\n    };\n    observableContainer.unsubscribeAll = () => {\n        subscriptions.clear();\n    };\n    observableContainer.subscriptionsCount = () => subscriptions.size;\n    return observableContainer;\n}\n//# sourceMappingURL=observable.js.map","import equals from './equals';\nconst empty = {};\nexport default function computed(sources, compute) {\n    let memoizedData = empty;\n    let attached = false;\n    const subscriptions = new Set();\n    const updateData = () => {\n        const computedData = compute(sources.map(getter => getter()));\n        if (!equals(computedData, memoizedData)) {\n            memoizedData = computedData;\n            return true;\n        }\n        return false;\n    };\n    const subscription = () => {\n        if (updateData()) {\n            subscriptions.forEach(subscription => subscription(memoizedData));\n        }\n    };\n    const attach = () => {\n        sources.forEach(source => source.subscribe(subscription));\n        attached = true;\n    };\n    const detach = () => {\n        sources.forEach(source => source.unsubscribe(subscription));\n        attached = false;\n    };\n    const checkSubscriptions = () => {\n        if (subscriptions.size && !attached) {\n            attach();\n        }\n        else if (!subscriptions.size && attached) {\n            detach();\n        }\n    };\n    const computedContainer = function () {\n        if (memoizedData === empty) {\n            updateData();\n        }\n        return memoizedData;\n    };\n    computedContainer.subscribe = s => {\n        subscriptions.add(s);\n        checkSubscriptions();\n    };\n    computedContainer.unsubscribe = s => {\n        subscriptions.delete(s);\n        checkSubscriptions();\n    };\n    computedContainer.unsubscribeAll = () => {\n        subscriptions.clear();\n        checkSubscriptions();\n    };\n    computedContainer.subscriptionsCount = () => subscriptions.size;\n    return computedContainer;\n}\n//# sourceMappingURL=computed.js.map","import equals from './equals';\n/**\n * Creates a new observable instance.\n * @param delay The delay time, in milliseconds.\n * @param initialValue The initial value.\n */\nexport default function throttled(delay, initialValue) {\n    let timeout;\n    let data = initialValue;\n    const subscriptions = new Set();\n    const updateValue = value => {\n        clearTimeout(timeout);\n        timeout = setTimeout(() => {\n            data = value;\n        }, delay);\n    };\n    const observableContainer = function (value) {\n        if (arguments.length) {\n            if (!equals(data, value)) {\n                updateValue(value);\n            }\n            return this;\n        }\n        else {\n            return data;\n        }\n    };\n    observableContainer.subscribe = subscription => {\n        subscriptions.add(subscription);\n    };\n    observableContainer.unsubscribe = subscription => {\n        subscriptions.delete(subscription);\n    };\n    observableContainer.unsubscribeAll = () => {\n        subscriptions.clear();\n    };\n    observableContainer.subscriptionsCount = () => subscriptions.size;\n    return observableContainer;\n}\n//# sourceMappingURL=throttled.js.map"],"names":[],"mappings":"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"}